# Colleague Feedback Bulk Upload Utility

This utility allows you to bulk upload colleague feedback data from Excel files into Performance360.

## Files

- `create-colleague-feedback-template.js` - Creates Excel template with sample data
- `colleague-feedback-bulk.js` - Main bulk upload script
- `colleague-feedback-data.xlsx` - Excel file with feedback data (generated by template)

## Setup

1. **Install Dependencies** (if not already installed):
   ```bash
   cd tests/playwright-tests
   npm install
   ```

2. **Create Excel Template**:
   ```bash
   node bulk-uploader/create-colleague-feedback-template.js
   ```
   This creates `tests/colleague-feedback-data.xlsx` with sample data and instructions.

3. **Prepare Your Data**:
   - Open `tests/colleague-feedback-data.xlsx`
   - Replace sample data with your actual colleague feedback data
   - Ensure all required fields are filled
   - Save the file

## Excel Template Structure

The template includes the following columns:

| Field | Description | Required | Options |
|-------|-------------|----------|---------|
| Username | Employee email for login (sender) | Yes | Any valid email |
| Password | Employee password for login | Yes | Any valid password |
| Quarter | Feedback quarter | Yes | Q1, Q2, Q3, Q4 |
| Year | Feedback year | Yes | Any year (e.g., 2024) |
| IsAnonymous | Whether feedback is anonymous | Yes | true, false |
| RecipientEmail | Email of colleague receiving feedback | Yes | Valid email of existing user |
| Appreciation | What you appreciate about this colleague | Yes | Any text describing positive aspects |
| Improvement | What this colleague could improve | Yes | Any text with constructive suggestions |
| Rating | Overall performance rating | Yes | 1, 2, 3, 4, 5 (1=Lowest, 5=Highest) |
| WouldWorkAgain | Would you work with this colleague again | Yes | true, false |

## Usage

### Prerequisites

1. **Start the Application**:
   ```bash
   # Terminal 1: Start backend
   cd backend
   npm run dev
   
   # Terminal 2: Start frontend
   cd frontend
   npm start
   ```

2. **Ensure Database is Seeded**:
   ```bash
   cd backend
   npm run db:seed
   ```

### Run Bulk Upload

```bash
cd playwright-tests
node bulk-uploader/colleague-feedback-bulk.js
```

## How It Works

1. **Reads Excel Data**: The script reads colleague feedback data from `tests/colleague-feedback-data.xlsx`

2. **Browser Automation**: Uses Playwright to automate browser interactions:
   - Logs in as each user
   - Navigates to colleague feedback page
   - Fills out the feedback form
   - Submits the feedback
   - Logs out and moves to next entry

3. **Error Handling**: 
   - Skips existing feedback for the same period
   - Continues processing even if one entry fails
   - Provides detailed logging

## Configuration

### Browser Settings

In `colleague-feedback-bulk.js`, you can modify:

```javascript
browser = await chromium.launch({ 
  headless: false, // Set to true for headless mode
  slowMo: 1000 // Slow down actions for better visibility
});
```

### Excel File Path

The script looks for the Excel file at:
```
tests/playwright-tests/tests/colleague-feedback-data.xlsx
```

## Sample Data

The template includes sample entries like:

```javascript
{
  Username: 'employee1@msg-global.com',
  Password: '123456',
  Quarter: 'Q1',
  Year: '2024',
  IsAnonymous: 'false',
  RecipientEmail: 'colleague1@msg-global.com',
  Appreciation: 'I really appreciate how John always takes the time to explain complex concepts clearly...',
  Improvement: 'John could improve by being more proactive in sharing updates...',
  Rating: 4,
  WouldWorkAgain: 'true'
}
```

## Troubleshooting

### Common Issues

1. **Excel File Not Found**:
   - Ensure you've run the template generator first
   - Check the file path in the script

2. **Login Failures**:
   - Verify user credentials in the Excel file
   - Ensure users exist in the database

3. **Element Not Found**:
   - Check that the application is running on `http://localhost:3000`
   - Verify the frontend is accessible

4. **Recipient Not Found**:
   - Ensure recipient emails exist in the database
   - Check email format and spelling

### Debug Mode

To see what's happening in real-time:
- Keep `headless: false` in the browser launch options
- The browser will open and you can watch the automation

## Notes

- The script processes feedback sequentially to avoid conflicts
- Each feedback submission includes a 2-second delay
- Failed entries are logged but don't stop the entire process
- The script checks for existing feedback to avoid duplicates

## Customization

You can modify the script to:
- Change the application URL
- Adjust timing delays
- Add additional validation
- Modify the feedback form interaction logic 